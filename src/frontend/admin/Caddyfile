# src/frontend/admin/Caddyfile
# FINAL VERSION â€” everything works: static files, SPA, /api, WebSocket, AND /scooters

:80 {
    # Serve static files
    root * /usr/share/caddy
    file_server

    handle /scooters {
        reverse_proxy system:3000
    }

    handle /api* {
        reverse_proxy system:3000
    }


    @websocket {
        header Connection *Upgrade*
        header Upgrade    websocket
    }
    reverse_proxy @websocket system:3000

    try_files {path} {path}/ index.html

    log {
        output stdout
        format console
        level DEBUG
    }
}