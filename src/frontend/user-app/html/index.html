<!DOCTYPE html>
<html lang="sv">
<head>

  <script>
    (function () {
      const prefersDark =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;
  
      const html = document.documentElement;
  
      html.classList.remove("light-mode", "dark-mode");

      html.classList.add(prefersDark ? "dark-mode" : "light-mode");

      localStorage.removeItem("theme");
    })();
  </script>

  

  <meta charset="UTF-8">
  <link rel="icon" href="/shared/img/favicon.ico" type="image/x-icon">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Spark - Anv√§ndarapp</title>

  <link rel="stylesheet" href="/shared/style/style.css">

  <script type="module">
    const INTRO_MS = 3500;

    const MAP_URL = "index-map.html";
    const LOGIN_URL = "user-app-login.html";

    function wait(ms) {
      return new Promise((r) => setTimeout(r, ms));
    }

    const params = new URLSearchParams(window.location.search);
    const tokenFromQuery = params.get("token");

    if (tokenFromQuery) {
      localStorage.setItem("token", tokenFromQuery);
      window.history.replaceState({}, document.title, window.location.pathname);
    }


    let token = localStorage.getItem('token');

    async function routeAfterIntro() {
      await wait(INTRO_MS);

      if (token) {
        window.location.replace(MAP_URL);
      } else {
        window.location.replace(LOGIN_URL);
      }
    }

    routeAfterIntro();
  </script>
</head>

<body>
  <div class="intro-card-container">
    <div class="intro-card" role="status" aria-label="Spark laddar">
      <picture>
        <source srcset="/shared/img/intro-dark.png" media="(prefers-color-scheme: dark)">
        <img src="/shared/img/intro.png" alt="Spark">
      </picture>
    </div>
</div>
</body>
</html>
